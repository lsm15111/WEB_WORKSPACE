<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body class="container">
    <h1>스마트폰 쇼핑몰</h1>
    <!-- 입력 영역 -->
    <table class="table table-hover">
        <tr>
            <th>기종</th>
            <td><input type="text" name="name" value=""></td>
        </tr>
        <tr>
            <th>가격</th>
            <td><input type="text" name="price" value=""></td>
        </tr>
        <tr>
            <th>회사</th>
            <td><input type="text" name="company" value=""></td>
        </tr>
        <tr>
            <th>제작연도</th>
            <td><input type="text" name="year" value=""></td>
        </tr>
        <tr>
            <th colspan="2">
                <input type="submit" class="btn btn-dark" value="등록">
            </th>

        </tr>
    </table>
    <!-- 검색 영역 -->
    검색 : <input type="text" id="searchInput" placeholder="검색어 입력">
    <input type="button" value="검색" id="searchBtn">
    <!-- 목록 영역 -->
    <div id="listBox">
        <table class="table table-hover">
            <thead>
                <th>번호</th>
                <th>기종</th>
                <th>가격</th>
                <th>제조사</th>
                <th>출시</th>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script src="https://unpkg.com/underscore@1.13.4/underscore-umd-min.js"></script>
    <script>
        const template = `<% phoneList.forEach(function(phone) { %>
                <tr>
                    <td><%=phone.pno %></td>
                    <td><a href="/detail/<%=phone.pno %>"><%=phone.name %></a></td>
                    <td><%=phone.price %></td>
                    <td><%=phone.company %></td>
                    <td><%=phone.year %></td>
                </tr>
                <% }); %>`;

        let phoneList = [
            { pno: 1, name: 'iphone10', price: 100, company: 'APPLE', year: 2020 },
            { pno: 2, name: 'galaxy', price: 90, company: 'SAMSUNG', year: 2020 },
            { pno: 3, name: 'iphone11', price: 110, company: 'APPLE', year: 2021 },
            { pno: 4, name: 'wide3', price: 70, company: 'SAMSUNG', year: 2022 }
        ];

        function drowTable(phoneList) {
            var render = _.template(template);
            var html = render({ phoneList });
            var tbody = document.querySelector('#listBox tbody');
            tbody.innerHTML = html;
        }
        drowTable(phoneList);
        var searchInput = document.querySelector('#searchInput');
        searchInput.addEventListener('keyup', function (e) {
            var keyword = e.currentTarget.value;
            var searchList = phoneList.filter((phone)=>{
                var n = keyword.toLowerCase();
                var text = phone.name.toLowerCase();
                var result = text.match(n);
                console.log(n);
                return result !=null;
            });
            drowTable(searchList);
        });

        function regexFinder(){
            var searchList = phoneList.filter((phone)=>{
                var n = keyword.toLowerCase();
                var text = phone.name.toLowerCase();
                var result = text.match(n);
                return result !=null;
            });
            return seachList
        }
    </script>
</body>

</html>